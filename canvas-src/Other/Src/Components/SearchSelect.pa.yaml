# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
ComponentDefinitions:
  SearchSelect:
    DefinitionType: CanvasComponent
    AccessAppScope: true
    CustomProperties:
      AutoHeight:
        PropertyKind: Output
        DisplayName: Auto Height
        Description: Propiedad personalizada
        DataType: Number
      CleanSearchValue:
        PropertyKind: Event
        DisplayName: Clean Search Value
        Description: Propiedad personalizada
        ReturnType: None
        Default: =
      SearchValue:
        PropertyKind: Input
        DisplayName: Search Value
        Description: Propiedad personalizada
        DataType: Text
        Default: ="Texto"
      SelectedValue:
        PropertyKind: Output
        DisplayName: Selected Value
        Description: Propiedad personalizada
        DataType: Record
      Source:
        PropertyKind: Input
        DisplayName: Source
        Description: Propiedad personalizada
        DataType: Table
        Default: |-
          =Table([{Name: ""}])
    Properties:
      AutoHeight: =AutoHeight.Y
      Fill: =
      Height: =Self.AutoHeight
      OnReset: =false
      SelectedValue: =SelectedValue
      Width: =350
    Children:
      - ContainerSearchSelect:
          Control: GroupContainer@1.4.0
          Variant: AutoLayout
          Properties:
            DropShadow: =DropShadow.None
            Height: =Parent.Height
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            Width: =Parent.Width
          Children:
            - ContainerValue:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =lblSelectedItem.Height + 16
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutMinHeight: =16
                  LayoutMinWidth: =16
                  PaddingBottom: =8
                  PaddingLeft: =8
                  PaddingRight: =8
                  PaddingTop: =8
                  Visible: =!IsBlank(SelectedValue)
                Children:
                  - lblSelectedItem:
                      Control: Text@0.0.51
                      Properties:
                        AutoHeight: =true
                        FillPortions: =1
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        Size: =12
                        Text: =SelectedValue.Name
                        Width: =Parent.Width
                        Wrap: =false
                  - ButtonCanvas3:
                      Control: Button@0.0.45
                      Properties:
                        Appearance: ='ButtonCanvas.Appearance'.Transparent
                        Icon: ="DismissCircle"
                        IconStyle: ='ButtonCanvas.IconStyle'.Outline
                        Layout: ='ButtonCanvas.Layout'.IconOnly
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        OnSelect: =Set(SelectedValue, Blank())
                        Width: =32
            - Gallery:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_OneTextVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  FillPortions: =0
                  Height: =Self.TemplateHeight * Self.AllItemsCount
                  Items: |-
                    =With(
                        { _searchValue: Trim(SearchSelect.SearchValue) },
                        If(
                            IsBlank(_searchValue),
                            Blank(),
                            Filter(
                                SearchSelect.Source,
                                StartsWith(Name, _searchValue)
                            )
                        )
                    )
                  TemplateSize: =40
                  Width: =Parent.Width
                Children:
                  - Title3:
                      Control: Label@2.5.1
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(50, 49, 48, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                        Height: =Self.Size * 1.8
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =10
                        Text: '=ThisItem.Name                                                                              '
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.TemplateWidth - 86
                        X: =16
                        Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                  - Rectangle2:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =RGBA(0, 18, 107, 1)
                        Height: =Parent.TemplateHeight
                        OnSelect: =Select(Parent)
                        Visible: =ThisItem.IsSelected
                        Width: =4
                  - btn:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =RGBA(255, 255, 255, 1)
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(56, 96, 178, 0)
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =RGBA(56, 96, 178, .1)
                        OnSelect: |-
                          =Set(SelectedValue, ThisItem);
                          SearchSelect.CleanSearchValue()
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: =
                        Width: =Parent.TemplateWidth
            - AutoHeight:
                Control: GroupContainer@1.4.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =1
                  LayoutMinHeight: =16
                  LayoutMinWidth: =16
                  Width: =Parent.Width
      - Spinner:
          Control: Spinner@1.4.6
          Properties:
            Height: =30
            SpinnerSize: ='Spinner.SpinnerSize'.ExtraSmall
            Visible: =Len(SearchSelect.SearchValue) > 0 && Gallery.AllItemsCount = 0
            Width: =30
            X: |-
              =//txtSearch.Width - Self.Width - 8
              0
            Y: |-
              =//txtSearch.Y + (txtSearch.Height - Self.Height) /2 
              0
